@page "/nekopage/{pageId}"
@rendermode InteractiveServer

@inject NekoClient nekoClient
@inject NavigationManager nav

<PageTitle>Подробности</PageTitle>

@if (nekoPost is null)
{
	<h2 class="alert-heading">Ошибка!</h2>
	<h3 class="alert alert-danger" role="alert">Данной страницы не существует</h3>
	<img src="/Images/pfelis/pf2.jpg" alt="ЭЭЭЭЭЭЭЭЭЭЭ" />
}
else
{
	<div class="card mb-4 mh-50 box-shadow">
		<strong class="d-inline-block col-md-12 text-primary">@nekoPost.Name</strong>
		<div style="flex: 1;">
			<img class="card-body d-flex flex-column align-items-start" src="@nekoPost.Image" alt="ЭЭЭЭЭЭЭЭЭЭЭ" style="width: 50vh;"/>
		</div>

		<div style="flex: 1; display: flex; flex-direction: column; justify-content: flex-start;">
			<div class="card-body d-flex flex-column align-items-end">
				<button class="btn btn-outline-secondary btn-lg btn-block" @onclick="Buy">КУПИТЬ</button>
				<a href="/" class="btn btn-outline-secondary btn-block">Назад</a>
				<a href="/nekopage/@(nekoClient.GetNekos().Length <= nekoPost.Id + 1 ? 0 : nekoPost.Id + 1)" class="btn btn-outline-secondary btn-block">Следующая</a>
			</div>
		</div>

		<div class="card-body">
			<ul>
				@foreach(var spec in nekoPost.Specifications)
				{
					<li>@spec.Key - @spec.Value</li>
				}
			</ul>
		</div>

		<div class="card-body">
			<p>@nekoPost.Description</p>
		</div>

		<div class="photo-scroll-container card-footer">
			<div class="photo-scroll-content">
				@foreach (string photo in nekoPost.Photos)
				{
					<img src="@photo" alt="ЭЭЭЭЭ" style="width: 25vh;">
				}
			</div>
		</div>
	</div>
}


@code {
	[Parameter]
	public required string pageId { get; set; }

	private NekoPost nekoPost = null;

	protected override void OnInitialized()
	{
		nekoPost = nekoClient.GetNekos().FirstOrDefault(n => n.Id == Convert.ToInt32(pageId));
	}

	private void Buy() 
	{ 
		nekoClient.DeletePost(nekoPost.Id);
		nav.NavigateTo("/");
	}
}
